-- Copyright (c) 2020 Digital Asset (Switzerland) GmbH and/or its affiliates. All rights reserved.
-- SPDX-License-Identifier: Apache-2.0

{-# OPTIONS_GHC -Wno-orphans #-}

{-# LANGUAGE FlexibleInstances #-}
{-# LANGUAGE MultiParamTypeClasses #-}
{-# LANGUAGE RankNTypes #-}

module DA.Daml.LF.Ast.Optics
  ( _PRSelfModule
  , builtinType
  , dataConsType
  , exprPartyLiteral
  , exprValueRef
  , moduleExpr
  , moduleModuleRef
  , packageRefs
  , templateExpr
  , typeModuleRef
  , unlocate
  , ModuleRef
  )
where

unlocate :: Prism' Expr a -> Prism' Expr a
unlocate p = prism inj proj
  where
    inj x = p # x
    proj e = case matching p (e ^. rightSpine _ELocation . _2) of
      Left _ -> Left e
      Right x -> Right x
